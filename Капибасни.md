При входе на сайт видно, что можно зарегистрироваться.

![image](https://github.com/user-attachments/assets/406c0368-11c8-43cf-913c-5c6965bb164c)

После предлагается посмотреть на учебный план.

![image](https://github.com/user-attachments/assets/57f720a4-72fe-45e8-8f64-9a4815249ad3)

Перед нами таблица с уроками, которые будут проходить. 
Видно, что можно добавить уроки в таблице «Ученик». 
Добавить уроки в других таблицах нельзя, т.к. у нас нет 
доступа к учетным записям учителей.

Наша глобальная цель задания – начать обучение и получить 
флаг. Но если мы нажмем кнопку «Начать обучение» сейчас, 
то будет ошибка.

![image](https://github.com/user-attachments/assets/b7012eef-bbea-43d7-8fa8-59b1d0311602)

Она возникает по двум причинам: 
1) В таблице «Ученик» нету 5 обязательных уроков. 
2) Есть пересечения в таблицах других преподов. Т.е. на 
одной позиции предметы нескольких преподов.

Как быть? Логично, что нужно попытаться изменить 
расписание других преподов. Возможно, нам поможет исходный 
код. 
Покапавшись в разных файлах можно найти файл lesson.go. 
Там прописана вся логика уроков: их добавление, изменение 
и **удаление**.

В коде есть две функции удаления. Чем они различаются?

![image](https://github.com/user-attachments/assets/5df11cdb-f4d6-4915-8509-78901ba7517c)

Это просто DeleteLesson. Она удаляет один урок. В GUI это 
функция привязана к этой кнопке (см. ниже). 

![image](https://github.com/user-attachments/assets/17b07af1-68d7-49c8-980a-a8aad256aba4)

При этом заметим в коде есть проверка на то, что удаляет урок 
именно владелец данного урока.

![image](https://github.com/user-attachments/assets/2e243493-44eb-40b3-a2d1-1d81b7f63e62)

Это BulkDeleteLessons. Она нужна, чтобы удалить несколько 
уроков одновременно (см. ниже).

![image](https://github.com/user-attachments/assets/68773c49-a9a4-4225-be52-f8bb1d54873e)

В обычном интерфейсе она выглядит вот так (Красная кнопка в 
верхнем левом углу). 

![image](https://github.com/user-attachments/assets/3f404ada-80a4-4573-9e96-64e2ac26af58)

Посмотрев в код функции можно понять, что проверки на owner’а 
нету. Поэтому ее скорее всего можно проэксплуатировать. 
Как это сделать. В моем случае был использован Burp Suite. 

Открываем Proxy -> Intercept. Выбираем несколько уроков, 
которые мы создали в таблице «Ученик». Врубаем Intercept. Тыкаем 
кнопку «Удалить выбранное». К нам пришел в Intercept запрос. 

![image](https://github.com/user-attachments/assets/6f1322c1-27e4-4d39-8c42-104be00d9db5)

Запросик как раз-таки обращается к bulk-delete, что нам и 
надо. Выглядит он так.

![image](https://github.com/user-attachments/assets/c9ecebdc-5d4a-4f71-9f90-6c1c2d469a18)

Видим, что в конце есть id наши удаляемых уроков. Нужно 
удалить уроки другие (которые мешают). Для этого узнаем id уроков, 
которые хотим удалить. Мой способ в этом деле прост. Просто тыкать 
на каждый нужный урок с включенным intercept. 

![image](https://github.com/user-attachments/assets/52dc976e-4335-4589-9fab-99e2f38fb058)

Видим id уроков. Теперь мы можем изменить запрос к bulk
delete, изменив список ids. 

![image](https://github.com/user-attachments/assets/b16193eb-567a-4612-80d2-8d59347e90fb)

Можно осуществить forward запроса (и еще нескольких, которые 
обновят инфу на экране) и можно получить картину такого вида:

![image](https://github.com/user-attachments/assets/e72c75a4-9399-40c3-820d-81ea83d5326f)

ПОБЕДА! Можем добавлять уроки, которых не хватило.

![image](https://github.com/user-attachments/assets/71bafb10-c9fe-4678-a241-a93078b64424)

Жмем кнопку «Начать обучение» и .. ..

![image](https://github.com/user-attachments/assets/d2ac45d5-514b-4390-866d-dd86e1bc46ee)

Получаем флаг 
Ответ: tctf{7Hi5_rEtURn_iS_driviNG_me_CraZy}
